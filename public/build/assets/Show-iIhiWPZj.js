import{b as se,a as o,u as _,j as e,H as Le,L as re,r as O}from"./app-IhE1m_BC.js";import{P as Ie}from"./ProjectLayout-B9ewv8ds.js";import{M as C,S as D}from"./SecondaryButton-Dl4pIxEi.js";import{P as m}from"./PrimaryButton-ButJWevn.js";import{I as s}from"./InputLabel-CilmzmeG.js";import{T as i}from"./TextInput-B8tOnSIo.js";import{g as Pe,i as Re,h as ne,j as Ee,f as I,b as le,c as de,e as Te,k as Fe}from"./Icons-CnTtMV9J.js";import"./AuthErrorHandler-B4xJ0iaO.js";import"./Dropdown-BywcanTi.js";import"./transition-r-pQ9FKK.js";const ie={present:"bg-emerald-100 text-emerald-800",absent:"bg-red-100 text-red-800",half_day:"bg-amber-100 text-amber-800",leave:"bg-blue-100 text-blue-800",late:"bg-orange-100 text-orange-800",excused:"bg-gray-100 text-gray-800"},qe=[{key:"contract",label:"Contract",icon:Pe},{key:"salary",label:"Salary",icon:Re},{key:"attendance",label:"Attendance",icon:ne},{key:"vacations",label:"Vacations",icon:ne},{key:"cnss",label:"CNSS",icon:Ee}],P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ce=(d,a)=>{if(!a?.length)return!1;const g=new Date(d);return a.some(b=>{if(b.status!=="approved")return!1;const U=new Date(b.start_date),R=new Date(b.end_date);return g>=U&&g<=R})};function Ke({project:d,worker:a,can:g}){const{flash:b}=se().props,U=se().props.currentProject?.primary_color||"#3B82F6",R="focus:border-[var(--project-primary)] focus:ring-[var(--project-primary)]",[N,oe]=o.useState("contract"),[xe,E]=o.useState(!1),[me,T]=o.useState(!1),[ue,F]=o.useState(!1),[he,q]=o.useState(!1),[V,W]=o.useState(null),[k,B]=o.useState(null),[pe,Q]=o.useState(!1),[S,z]=o.useState(null),[x,G]=o.useState(new Date().getMonth()+1),[y,X]=o.useState(new Date().getFullYear()),[A,Z]=o.useState([]),[ge,ee]=o.useState(!1),te=new Date,w=_({month:String(te.getMonth()+1),year:String(te.getFullYear())}),u=_({payment_method:"transfer",amount:"",reference:"",payment_date:new Date().toISOString().slice(0,10),notes:""}),h=_({gross_amount:"",net_amount:"",absent_days:"",attendance_deduction:""}),c=_({type:"cdi",status:"draft",start_date:new Date().toISOString().slice(0,10),end_date:"",salary_amount:"",salary_currency:"MAD",notes:""}),f=_({start_date:"",end_date:"",notes:""}),p=_({registration_number:"",registration_date:"",status:"active",notes:""}),l=_({date:"",dates:[],status:"present",notes:""}),H=()=>{a?.id&&(ee(!0),window.axios.get(route("projects.modules.hr.workers.attendances.index",[d.id,a.id]),{params:{month:x,year:y}}).then(t=>{Z(t.data.attendances||[])}).catch(()=>Z([])).finally(()=>ee(!1)))};o.useEffect(()=>{N==="attendance"&&a?.id&&H()},[N,a?.id,x,y]);const ae=t=>{if(typeof t=="object"&&t?.id)z(t),l.setData({date:t.date,dates:[],status:t.status,notes:t.notes||""});else{const r=t||1,n=`${y}-${String(x).padStart(2,"0")}-${String(r).padStart(2,"0")}`;z(null),l.setData({date:n,dates:[n],status:"present",notes:""})}Q(!0)},ye=t=>{const r=l.data.dates||[],n=r.includes(t)?r.filter(j=>j!==t):[...r,t].sort();l.setData("dates",n)},L=()=>{Q(!1),z(null)},je=t=>{t.preventDefault();const r=l.data.dates||[];S?(l.transform(n=>({date:n.date,status:n.status,notes:n.notes})),l.post(route("projects.modules.hr.workers.attendances.store",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{L(),H()}})):r.length>0&&(l.transform(n=>({dates:n.dates,status:n.status,notes:n.notes})),l.post(route("projects.modules.hr.workers.attendances.storeBulk",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{L(),H()}}))},ve=t=>{t.can_delete&&O.delete(route("projects.modules.hr.workers.attendances.destroy",[d.id,t.id]),{preserveScroll:!0,onSuccess:()=>H()})},fe=t=>{t.preventDefault(),w.post(route("projects.modules.hr.workers.salaries.generate",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{E(!1),w.reset()}})},be=t=>{W(t),u.setData({payment_method:"transfer",amount:t.net_amount.toString(),reference:"",payment_date:new Date().toISOString().slice(0,10),notes:""})},Ne=t=>{B(t),h.setData({gross_amount:t.gross_amount.toString(),net_amount:t.net_amount.toString(),absent_days:(t.absent_days??0).toString(),attendance_deduction:(t.attendance_deduction??0).toString()})},Se=t=>{t.preventDefault(),k&&h.patch(route("projects.modules.hr.workers.salaries.update",[d.id,k.id]),{preserveScroll:!0,onSuccess:()=>B(null)})},we=t=>{t.can_delete&&t.status!=="paid"&&confirm(`Delete salary for ${P[t.month-1]} ${t.year}?`)&&O.delete(route("projects.modules.hr.workers.salaries.destroy",{project:d.id,salary:t.id}),{preserveScroll:!0})},_e=t=>{t.preventDefault(),V&&u.post(route("projects.modules.hr.workers.salaries.pay",[d.id,V.id]),{preserveScroll:!0,onSuccess:()=>{W(null)}})},Ce=t=>{t.preventDefault(),c.post(route("projects.modules.hr.workers.contracts.store",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{T(!1),c.reset()}})},De=t=>{t.preventDefault(),f.post(route("projects.modules.hr.workers.vacations.store",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{F(!1),f.reset()}})},ke=t=>{t.preventDefault(),p.post(route("projects.modules.hr.workers.cnss.store",[d.id,a.id]),{preserveScroll:!0,onSuccess:()=>{q(!1),p.reset()}})},Ae=t=>{O.post(route("projects.modules.hr.vacations.approve",[d.id,t.id]),{},{preserveScroll:!0})},Me=t=>{O.post(route("projects.modules.hr.vacations.reject",[d.id,t.id]),{rejection_reason:""},{preserveScroll:!0})},M=`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${R}`,Y=`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${R}`;return a?e.jsxs(Ie,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{href:route("projects.modules.hr.workers.index",d.id),className:"rounded-lg p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:e.jsx(Te,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-indigo-100 text-indigo-600",children:e.jsx(Fe,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:a.full_name}),e.jsxs("p",{className:"mt-0.5 text-sm text-gray-500",children:[a.employee_number&&`#${a.employee_number} · `,a.cnss_number&&`CNSS ${a.cnss_number} · `,a.email||a.phone||"No contact"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:g?.update&&e.jsxs(re,{href:route("projects.modules.hr.workers.index",d.id),className:"inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(le,{className:"h-4 w-4"}),"Edit"]})})]}),children:[e.jsx(Le,{title:`${d?.name} - ${a.full_name}`}),b?.error&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:b.error}),b?.success&&e.jsx("div",{className:"mb-4 rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700",children:b.success}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex gap-6",children:qe.map(({key:t,label:r,icon:n})=>e.jsxs("button",{type:"button",onClick:()=>oe(t),className:`flex items-center gap-2 border-b-2 py-4 text-sm font-medium ${N===t?"border-[var(--project-primary)] text-[var(--project-primary)]":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"}`,children:[e.jsx(n,{className:"h-5 w-5"}),r]},t))})}),N==="contract"&&e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Contracts"}),g?.create_contract&&e.jsxs(m,{onClick:()=>T(!0),children:[e.jsx(I,{className:"h-4 w-4"}),"Add Contract"]})]}),a.contracts?.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Dates"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Salary"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.contracts.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:t.type_label}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="active"?"bg-emerald-100 text-emerald-800":t.status==="draft"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:t.status_label})}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600",children:[t.start_date," – ",t.end_date||"—"]}),e.jsxs("td",{className:"px-6 py-4 text-sm text-right font-medium",children:[Number(t.salary_amount).toLocaleString()," ",t.salary_currency]})]},t.id))})]}):e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"No contracts yet. Add a contract to enable salary generation."})]}),N==="salary"&&e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Salaries"}),g?.create_salary&&e.jsxs(m,{onClick:()=>E(!0),children:[e.jsx(I,{className:"h-4 w-4"}),"Generate Salary"]})]}),a.salaries?.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Period"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Working days"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Gross"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Net"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.salaries.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:[P[t.month-1]," ",t.year]}),e.jsx("td",{className:"px-6 py-4 text-sm text-right text-gray-600",children:t.working_days??"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-right",children:Number(t.gross_amount).toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 text-sm text-right font-medium",children:[Number(t.net_amount).toLocaleString(),(t.absent_days>0||t.attendance_deduction>0)&&e.jsxs("span",{className:"block text-xs font-normal text-amber-600",title:"Absent days deduction",children:["−",t.absent_days,"d (",Number(t.attendance_deduction).toLocaleString(),")"]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="paid"?"bg-emerald-100 text-emerald-800":t.status==="generated"?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:t.status_label})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status==="generated"&&e.jsx("button",{type:"button",onClick:()=>be(t),className:"text-sm font-medium",style:{color:U},children:"Record Payment"}),t.can_update&&e.jsx("button",{type:"button",onClick:()=>Ne(t),className:"text-sm text-gray-600 hover:text-gray-900",children:e.jsx(le,{className:"h-4 w-4"})}),t.can_delete&&t.status!=="paid"&&e.jsx("button",{type:"button",onClick:()=>we(t),className:"text-sm text-red-600 hover:text-red-700",title:"Delete salary (only unpaid)",children:e.jsx(de,{className:"h-4 w-4"})})]})})]},t.id))})]}):e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"No salaries generated yet. Ensure the worker has an active contract, then generate a salary."})]}),N==="attendance"&&e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Attendance"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>{x===1?(G(12),X(t=>t-1)):G(t=>t-1)},className:"rounded p-1.5 text-gray-600 hover:bg-gray-200",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("span",{className:"min-w-[120px] text-center font-medium text-gray-900",children:[P[x-1]," ",y]}),e.jsx("button",{type:"button",onClick:()=>{x===12?(G(1),X(t=>t+1)):G(t=>t+1)},className:"rounded p-1.5 text-gray-600 hover:bg-gray-200",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),g?.create_attendance&&e.jsxs(m,{onClick:()=>ae(1),children:[e.jsx(I,{className:"h-4 w-4"}),"Add Attendance"]})]}),e.jsx("div",{className:"p-6",children:ge?e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 sm:grid-cols-10 md:grid-cols-15",style:{gridTemplateColumns:"repeat(auto-fill, minmax(2.5rem, 1fr))"},children:Array.from({length:new Date(y,x,0).getDate()},(t,r)=>r+1).map(t=>{const r=`${y}-${String(x).padStart(2,"0")}-${String(t).padStart(2,"0")}`,n=A.find(K=>K.date===r),j=ce(r,a.vacations),v=n||(j?{status:"leave",status_label:"Vacation"}:null);return e.jsxs("button",{type:"button",onClick:()=>g?.create_attendance&&ae(n||t),className:`min-h-[2.5rem] rounded-lg border p-1.5 text-center text-xs font-medium transition ${v?`${ie[v.status]||"bg-gray-100"} cursor-pointer hover:ring-2`:"border-gray-200 bg-gray-50 text-gray-400 hover:border-gray-300 hover:bg-gray-100"}`,title:v?`${v.status_label}${n?.notes?`: ${n.notes}`:""}`:"Add",children:[e.jsx("span",{className:"block",children:t}),v&&e.jsx("span",{className:"block truncate text-[10px]",children:v.status_label})]},t)})}),(A.length>0||(a.vacations?.filter(t=>t.status==="approved").length||0)>0)&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-4 text-sm text-gray-600",children:["present","absent","half_day","leave","late","excused"].map(t=>{const r=A.filter($=>$.status===t).length,n=t==="leave"?Array.from({length:new Date(y,x,0).getDate()},($,J)=>J+1).filter($=>{const J=`${y}-${String(x).padStart(2,"0")}-${String($).padStart(2,"0")}`;return ce(J,a.vacations)&&!A.find($e=>$e.date===J)}).length:0,j=r+n;if(j===0)return null;const v=A.find($=>$.status===t)?.status_label||(t==="leave"?"Vacation/Leave":t),K=ie[t]?.split(" ")[0]||"bg-gray-300";return e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${K}`}),v,": ",j]},t)})})]})})]}),N==="vacations"&&e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Vacations (Congés)"}),g?.create_vacation&&e.jsxs(m,{onClick:()=>F(!0),children:[e.jsx(I,{className:"h-4 w-4"}),"Request Vacation"]})]}),a.vacations?.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Period"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.vacations.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[t.start_date," – ",t.end_date]}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600",children:[t.days_count," days"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="approved"?"bg-emerald-100 text-emerald-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"}`,children:t.status_label})}),e.jsx("td",{className:"px-6 py-4 text-right",children:t.status==="pending"&&t.can_approve&&e.jsxs("span",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>Ae(t),className:"text-sm font-medium text-emerald-600 hover:text-emerald-500",children:"Approve"}),e.jsx("button",{type:"button",onClick:()=>Me(t),className:"text-sm font-medium text-red-600 hover:text-red-500",children:"Reject"})]})})]},t.id))})]}):e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"No vacation requests yet."})]}),N==="cnss"&&e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"CNSS Records"}),g?.create_cnss&&e.jsxs(m,{onClick:()=>q(!0),children:[e.jsx(I,{className:"h-4 w-4"}),"Add CNSS Record"]})]}),a.cnss_records?.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Registration #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.cnss_records.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:t.registration_number}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:t.registration_date||"—"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium capitalize ${t.status==="active"?"bg-emerald-100 text-emerald-800":"bg-gray-100 text-gray-800"}`,children:t.status})})]},t.id))})]}):e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"No CNSS records yet."})]}),xe&&e.jsx(C,{show:!0,onClose:()=>E(!1),maxWidth:"sm",children:e.jsxs("form",{onSubmit:fe,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Generate Salary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Month"}),e.jsx("select",{value:w.data.month,onChange:t=>w.setData("month",t.target.value),className:M+" w-full",children:P.map((t,r)=>e.jsx("option",{value:r+1,children:t},r))})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Year"}),e.jsx(i,{type:"number",min:"2020",max:"2100",value:w.data.year,onChange:t=>w.setData("year",t.target.value),className:"block w-full",required:!0})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Salary is calculated from working days (Mon–Fri) in the month. Net = Gross − (absent days × daily rate)."})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>E(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:w.processing,children:"Generate"})]})]})}),k&&e.jsx(C,{show:!0,onClose:()=>B(null),maxWidth:"sm",children:e.jsxs("form",{onSubmit:Se,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Salary"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[P[k.month-1]," ",k.year," · ",k.working_days," working days"]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Gross Amount"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:h.data.gross_amount,onChange:t=>h.setData("gross_amount",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Net Amount"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:h.data.net_amount,onChange:t=>h.setData("net_amount",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Absent Days"}),e.jsx(i,{type:"number",step:"0.1",min:"0",value:h.data.absent_days,onChange:t=>h.setData("absent_days",t.target.value),className:"block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Attendance Deduction"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:h.data.attendance_deduction,onChange:t=>h.setData("attendance_deduction",t.target.value),className:"block w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>B(null),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:h.processing,children:"Save"})]})]})}),V&&e.jsx(C,{show:!0,onClose:()=>W(null),maxWidth:"md",children:e.jsxs("form",{onSubmit:_e,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Record Salary Payment"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Net amount: ",Number(V.net_amount).toLocaleString()]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Amount"}),e.jsx(i,{type:"number",step:"0.01",min:"0.01",value:u.data.amount,onChange:t=>u.setData("amount",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Payment Method"}),e.jsxs("select",{value:u.data.payment_method,onChange:t=>u.setData("payment_method",t.target.value),className:M+" w-full",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"transfer",children:"Transfer"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Payment Date"}),e.jsx(i,{type:"date",value:u.data.payment_date,onChange:t=>u.setData("payment_date",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Reference"}),e.jsx(i,{value:u.data.reference,onChange:t=>u.setData("reference",t.target.value),className:"block w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>W(null),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:u.processing,children:"Record Payment"})]})]})}),me&&e.jsx(C,{show:!0,onClose:()=>T(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:Ce,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Contract"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Type"}),e.jsxs("select",{value:c.data.type,onChange:t=>c.setData("type",t.target.value),className:M+" w-full",children:[e.jsx("option",{value:"cdi",children:"CDI (Indefinite)"}),e.jsx("option",{value:"cdd",children:"CDD (Fixed-term)"}),e.jsx("option",{value:"freelance",children:"Freelance"})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Status"}),e.jsxs("select",{value:c.data.status,onChange:t=>c.setData("status",t.target.value),className:M+" w-full",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Start Date"}),e.jsx(i,{type:"date",value:c.data.start_date,onChange:t=>c.setData("start_date",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"End Date (CDD)"}),e.jsx(i,{type:"date",value:c.data.end_date,onChange:t=>c.setData("end_date",t.target.value),className:"block w-full"})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Salary Amount"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:c.data.salary_amount,onChange:t=>c.setData("salary_amount",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Notes"}),e.jsx("textarea",{value:c.data.notes,onChange:t=>c.setData("notes",t.target.value),rows:2,className:Y+" w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>T(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:c.processing,children:"Add Contract"})]})]})}),ue&&e.jsx(C,{show:!0,onClose:()=>F(!1),maxWidth:"sm",children:e.jsxs("form",{onSubmit:De,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Request Vacation"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Start Date"}),e.jsx(i,{type:"date",value:f.data.start_date,onChange:t=>f.setData("start_date",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"End Date"}),e.jsx(i,{type:"date",value:f.data.end_date,onChange:t=>f.setData("end_date",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Notes"}),e.jsx("textarea",{value:f.data.notes,onChange:t=>f.setData("notes",t.target.value),rows:2,className:Y+" w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>F(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:f.processing,children:"Submit Request"})]})]})}),pe&&e.jsx(C,{show:!0,onClose:L,maxWidth:S?"sm":"md",children:e.jsxs("form",{onSubmit:je,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:S?"Edit Attendance":"Add Attendance"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[S?e.jsxs("div",{children:[e.jsx(s,{value:"Date"}),e.jsx(i,{type:"date",value:l.data.date,onChange:t=>l.setData("date",t.target.value),className:"block w-full",required:!0})]}):e.jsxs("div",{children:[e.jsx(s,{value:"Select days"}),e.jsx("div",{className:"mt-2 grid grid-cols-7 gap-1",children:Array.from({length:new Date(y,x,0).getDate()},(t,r)=>r+1).map(t=>{const r=`${y}-${String(x).padStart(2,"0")}-${String(t).padStart(2,"0")}`,n=(l.data.dates||[]).includes(r),j=A.find(v=>v.date===r);return e.jsxs("label",{className:`flex cursor-pointer flex-col items-center rounded border p-2 text-center text-xs transition ${n?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300"} ${j?"opacity-60":""}`,children:[e.jsx("input",{type:"checkbox",checked:n,onChange:()=>ye(r),className:"sr-only"}),e.jsx("span",{className:"font-medium",children:t}),j&&e.jsx("span",{className:"text-[10px] text-gray-500 truncate",children:j.status_label})]},t)})}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:[(l.data.dates||[]).length," day(s) selected."]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Status"}),e.jsxs("select",{value:l.data.status,onChange:t=>l.setData("status",t.target.value),className:M+" w-full",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"half_day",children:"Half day"}),e.jsx("option",{value:"leave",children:"Leave"}),e.jsx("option",{value:"late",children:"Late"}),e.jsx("option",{value:"excused",children:"Excused"})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Notes"}),e.jsx("textarea",{value:l.data.notes,onChange:t=>l.setData("notes",t.target.value),rows:2,className:Y+" w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("div",{children:S?.can_delete&&e.jsxs("button",{type:"button",onClick:()=>{confirm("Remove this attendance record?")&&(ve(S),L())},className:"text-sm text-red-600 hover:text-red-500",children:[e.jsx(de,{className:"inline h-4 w-4 mr-1"}),"Remove"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{type:"button",onClick:L,children:"Cancel"}),e.jsxs(m,{type:"submit",disabled:l.processing||!S&&(l.data.dates||[]).length===0,children:["Save",!S&&(l.data.dates||[]).length>0?` (${(l.data.dates||[]).length} days)`:""]})]})]})]})}),he&&e.jsx(C,{show:!0,onClose:()=>q(!1),maxWidth:"sm",children:e.jsxs("form",{onSubmit:ke,className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add CNSS Record"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Registration Number"}),e.jsx(i,{value:p.data.registration_number,onChange:t=>p.setData("registration_number",t.target.value),className:"block w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Registration Date"}),e.jsx(i,{type:"date",value:p.data.registration_date,onChange:t=>p.setData("registration_date",t.target.value),className:"block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Status"}),e.jsxs("select",{value:p.data.status,onChange:t=>p.setData("status",t.target.value),className:M+" w-full",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Notes"}),e.jsx("textarea",{value:p.data.notes,onChange:t=>p.setData("notes",t.target.value),rows:2,className:Y+" w-full"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>q(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:p.processing,children:"Add"})]})]})})]}):null}export{Ke as default};

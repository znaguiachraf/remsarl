import{b,a as v,j as e,H as w,L as u,r as k}from"./app-D_JLr605.js";import{P as _}from"./ProjectLayout-BLz5VXiF.js";import{c as N,l as S,i as C}from"./Icons-BeQ83LeY.js";import"./AuthErrorHandler-DUQsMJae.js";import"./SecondaryButton-C5Psiqnm.js";import"./transition-BeUOXmgI.js";import"./Dropdown-BPdzR8s0.js";const D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],M={pending:"bg-amber-100 text-amber-800",approved:"bg-emerald-100 text-emerald-800",rejected:"bg-red-100 text-red-800"};function $(a,n){const x=new Date(a,n-1,1),d=new Date(a,n,0),c=x.getDay(),r=d.getDate(),i=c+r,y=Math.ceil(i/7),s=[];for(let l=0;l<c;l++)s.push(null);for(let l=1;l<=r;l++)s.push(l);const o=y*7-s.length;for(let l=0;l<o;l++)s.push(null);return{cells:s,daysInMonth:r}}function A(a,n,x,d){if(!d)return[];const c=`${n}-${String(x).padStart(2,"0")}-${String(d).padStart(2,"0")}`;return(a||[]).filter(r=>r.start<=c&&r.end>=c)}function H({project:a,workersSummary:n=[],calendarEvents:x=[],vacations:d,workers:c=[],filters:r={}}){const i=b().props.currentProject?.primary_color||"#3B82F6",y="focus:border-[var(--project-primary)] focus:ring-[var(--project-primary)]",s=r.year||new Date().getFullYear(),[o,l]=v.useState(new Date().getMonth()+1),j=t=>{k.get(route("projects.modules.hr.vacations.index",a.id),{...r,...t},{preserveState:!0})},{cells:f}=$(s,o),h=`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${y}`;return e.jsxs(_,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{href:route("projects.modules.hr.workers.index",a.id),className:"rounded-lg p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:e.jsx(C,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Vacations"}),e.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:"View vacation balance, calendar & history"})]})]}),e.jsxs(u,{href:route("projects.modules.hr.workers.index",a.id),className:"inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(N,{className:"h-4 w-4"}),"Workers"]})]}),children:[e.jsx(w,{title:`${a?.name} - Vacations`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 rounded-lg border border-gray-200 bg-white p-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Year"}),e.jsx("select",{value:r.year||s,onChange:t=>j({year:t.target.value}),className:h+" max-w-[100px]",children:[s-2,s-1,s,s+1,s+2].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("label",{className:"ml-4 text-sm font-medium text-gray-700",children:"Worker"}),e.jsxs("select",{value:r.worker_id||"",onChange:t=>j({worker_id:t.target.value||void 0}),className:h+" max-w-[200px]",children:[e.jsx("option",{value:"",children:"All"}),c.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("label",{className:"ml-4 text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:r.status||"",onChange:t=>j({status:t.target.value||void 0}),className:h+" max-w-[120px]",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-gray-500"}),e.jsxs("h3",{className:"font-medium text-gray-900",children:["Vacation balance by worker (",s,")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Worker"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Allocated"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Used"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Remaining"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Profile"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:t.worker_name}),e.jsxs("td",{className:"px-6 py-4 text-right text-gray-600",children:[t.allocated," days"]}),e.jsxs("td",{className:"px-6 py-4 text-right text-amber-600",children:[t.used," days"]}),e.jsxs("td",{className:"px-6 py-4 text-right text-emerald-600",children:[t.remaining," days"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(u,{href:route("projects.modules.hr.workers.show",[a.id,t.worker_id]),className:"text-sm font-medium hover:underline",style:{color:i},children:"View"})})]},t.worker_id))})]})}),n.length===0&&e.jsx("div",{className:"px-6 py-8 text-center text-sm text-gray-500",children:"No workers in this project."})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("h3",{className:"flex items-center gap-2 font-medium text-gray-900",children:[e.jsx(S,{className:"h-5 w-5",style:{color:i}}),"Calendar — approved vacations"]}),e.jsx("select",{value:o,onChange:t=>l(Number(t.target.value)),className:h+" max-w-[140px]",children:D.map((t,m)=>e.jsxs("option",{value:m+1,children:[t," ",s]},t))})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"bg-gray-50 py-2 text-center text-xs font-medium text-gray-500",children:t},t)),f.map((t,m)=>{const p=A(x,s,o,t);return e.jsxs("div",{className:"min-h-[80px] bg-white p-1 text-sm",children:[t!=null&&e.jsx("span",{className:"text-gray-700",children:t}),p.length>0&&e.jsxs("div",{className:"mt-1 space-y-0.5",children:[p.slice(0,2).map(g=>e.jsx("div",{className:"truncate rounded px-1 py-0.5 text-xs text-white",style:{backgroundColor:i},title:`${g.title} (${g.days_count} days)`,children:g.title},g.id)),p.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",p.length-2]})]})]},m)})]})})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"font-medium text-gray-900",children:"Vacation history & requests"})}),d?.data?.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Worker"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Period"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.jsx(u,{href:route("projects.modules.hr.workers.show",[a.id,t.worker_id]),className:"hover:underline",style:{color:i},children:t.worker_name})}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600",children:[t.start_date," – ",t.end_date]}),e.jsxs("td",{className:"px-6 py-4 text-right text-gray-600",children:[t.days_count," days"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${M[t.status]||"bg-gray-100 text-gray-800"}`,children:t.status_label})})]},t.id))})]})}),d?.meta?.last_page>1&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-100 flex justify-end gap-2",children:d.links?.slice(1,-1).map((t,m)=>e.jsx("a",{href:t.url||"#",className:`rounded px-3 py-1 text-sm ${t.active?"font-medium":"text-gray-600 hover:bg-gray-100"}`,style:t.active?{backgroundColor:`${i}26`,color:i}:{},children:t.label},m))})]}):e.jsx("div",{className:"px-6 py-12 text-center text-sm text-gray-500",children:"No vacation records for the selected filters."})]})]})]})}export{H as default};
